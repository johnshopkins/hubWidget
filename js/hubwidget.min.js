jQuery(document).ready(function(e){e("#hubWidget").hubWidget()});var hubJS=function(e,t){var n,r={version:0};return{userSettings:{},baseUrl:"http://api.hub.jhu.edu/",init:function(t){n=this;n.userSettings=e.extend({},r,t)},get:function(r,i,s){var i=e.extend({},i);i.v=n.userSettings.version;if(i.id){r=r+"/"+i.id;delete i.id}t.get({url:n.baseUrl+r,dataType:"jsonp",data:i,success:s,fail:n.userSettings.fail})},articles:{find:function(t,r){var t=e.extend({},t);return n.get("articles",t,r)}}}}(jQuery,simplyAjax),widgetCreator=function(e,t){var n;return{data:{},widget:{},defaultTitle:"News from the Hub",defaultCount:5,init:function(){n=this;return n},create:function(e){n=this;n.widget=e;n.extractDataAttrs();n.widget.html(n.createInitialHtml());t.init({v:0});t.baseUrl="http://api.hub.jhu.edu/";n.getArticles();return n.widget},extractDataAttrs:function(){n.data={count:parseInt(n.widget.attr("data-count"))||n.defaultCount,tags:n.widget.attr("data-tags")||null,title:n.widget.attr("data-title")||n.defaultTitle,topics:n.widget.attr("data-topics")||null}},createInitialHtml:function(){var e='<div class="header">'+n.data.title+"</div>";e+='<div class="content loading"></div>';e+='<div class="hubpower clearfix"><div class="link"><a href="http://hub.jhu.edu">http://hub.jhu.edu</a></div><div class="image"><a href="http://hub.jhu.edu"><span>Powered by the Hub</span></a></div></div>';return e},getArticles:function(){var e=n.utility.compileData();t.articles.find(e,function(e){e.error?n.displayError():n.populateWidget(e._embedded.articles)})},populateWidget:function(t){n.widget.find(".content").removeClass("loading");n.widget.find(".content").html(e("<ul>"));for(var r=0,i=t.length;r<i;r++){var s=t[r],o='<li><p class="headline"><a href="'+s.url+'">'+s.headline+"</a></p>";o+='<p class="pubdate">'+n.utility.getPublishDate(s.publish_date)+"</a></p></li>";n.widget.find("ul").append(o)}},displayError:function(){n.widget.find(".content").html('<p>Sorry, no results were found. Trying checking out <a href="http://hub.jhu.edu">The Hub</a> for the latest Johns Hopkins news.</p>')},utility:{getPublishDate:function(e){var t=new Date(e*1e3),r=n.utility.getMonth(t),i=t.getDate(),s=t.getFullYear();return fullDate=r+" "+i+", "+s},getMonth:function(e){var t=["January","February","March","April","May","June","July","August","September","October","November","December"];return t[e.getMonth()]},compileData:function(){var t={};t.per_page=e.isNumeric(n.data.count)?n.data.count:n.defaultCount;n.data.topics&&(t.topics=n.utility.cleanList(n.data.topics));n.data.tags&&(t.tags=n.utility.cleanList(n.data.tags));return t},cleanList:function(e){return e.replace(/\s/g,"")}}}}(jQuery,hubJS);