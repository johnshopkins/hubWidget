Array.prototype.indexOf||(Array.prototype.indexOf=function(e){"use strict";if(this==null)throw new TypeError;var t=Object(this),n=t.length>>>0;if(n===0)return-1;var r=0;if(arguments.length>1){r=Number(arguments[1]);r!=r?r=0:r!=0&&r!=Infinity&&r!=-Infinity&&(r=(r>0||-1)*Math.floor(Math.abs(r)))}if(r>=n)return-1;var i=r>=0?r:Math.max(n-Math.abs(r),0);for(;i<n;i++)if(i in t&&t[i]===e)return i;return-1});var simplyAjax=function(){function t(){if(typeof XMLHttpRequest!="undefined")e=new XMLHttpRequest;else{var t=["Microsoft.XmlHttp","MSXML2.XmlHttp","MSXML2.XmlHttp.3.0","MSXML2.XmlHttp.4.0","MSXML2.XmlHttp.5.0"];for(var n=0,r=t.length;n<r;n++)try{e=new ActiveXObject(t[n]);break}catch(i){}}}function n(){return((1+Math.random())*65536|0).toString(16).substring(1)}function r(){return"simplyAjax_"+n()+n()+n()+n()+n()}function i(e){var t=document.createElement("script");t.src=e;document.body.appendChild(t)}function s(e){var t="",n=!1;for(var r in e){n&&(t+="&");t+=r+"="+e[r];n=!0}return"?"+t}var e;return{get:function(n){if(n.dataType&&n.dataType.toLowerCase()=="jsonp"){var o=r();simplyAjax[o]=n.success;n.data.callback="simplyAjax."+o;var u=n.url+s(n.data);i(u)}else{var u=n.url+s(n.data);t();e.onreadystatechange=function(){e.readyState===4&&(e.status==200?n.success(e.responseText,e.status,e.statusText):n.fail(e.status,e.statusText))};e.open("GET",u,!0);e.send(null)}}}}(),hubJS=function(e){var t,n={version:0,key:null};return{userSettings:{},baseUrl:"http://api.hub.jhu.edu/",init:function(e){t=this;t.userSettings=t.utility.extend({},n,e)},get:function(n,r,i){var r=t.utility.extend({},r);r.v=t.userSettings.version;r.key=t.userSettings.key;if(r.id){n=n+"/"+r.id;delete r.id}e.get({url:t.baseUrl+n,dataType:"jsonp",data:r,success:i,fail:t.userSettings.fail})},articles:{find:function(e,n){var e=t.utility.extend({},e);t.get("articles",e,n)}},utility:{extend:function(){for(var e=1,t=arguments.length;e<t;e++)for(var n in arguments[e])arguments[e].hasOwnProperty(n)&&(arguments[0][n]=arguments[e][n]);return arguments[0]}}}}(simplyAjax),widgetCreator=function(e){var t;return{data:{},defaultTitle:"News from the Hub",defaultCount:5,init:function(){t=this;return t},create:function(){t=this;t.widget=document.getElementById("hubWidget");t.extractDataAttrs();t.widget.innerHTML=t.createInitialHtml();var n=t.widget.getAttribute("key")||null;e.init({v:0,key:n});t.getArticles();return t},extractDataAttrs:function(){t.data={count:parseInt(t.widget.getAttribute("data-count"))||t.defaultCount,tags:t.widget.getAttribute("data-tags")||null,title:t.widget.getAttribute("data-title")||t.defaultTitle,topics:t.widget.getAttribute("data-topics")||null}},createInitialHtml:function(){var e='<div class="header">'+t.data.title+"</div>";e+='<div id="hubWidgetContent" class="loading"></div>';e+='<div class="hubpower clearfix"><div class="link"><a href="http://hub.jhu.edu">http://hub.jhu.edu</a></div><div class="image"><a href="http://hub.jhu.edu"><span>Powered by the Hub</span></a></div></div>';return e},getArticles:function(){var n=t.utility.compileData();e.articles.find(n,function(e){e.error?t.displayError():t.populateWidget(e._embedded.articles)})},populateWidget:function(e){var n="<ul>";for(var r=0,i=e.length;r<i;r++){var s=e[r];n+='<li><p class="headline"><a href="'+s.url+'">'+s.headline+"</a></p>";n+='<p class="pubdate">'+t.utility.getPublishDate(s.publish_date)+"</a></p></li>"}n+="</ul";t.utility.removeClass(document.getElementById("hubWidgetContent"),"loading");document.getElementById("hubWidgetContent").innerHTML=n},displayError:function(){t.utility.removeClass(document.getElementById("hubWidgetContent"),"loading");document.getElementById("hubWidgetContent").innerHTML='<p>Sorry, no results were found. Trying checking out <a href="http://hub.jhu.edu">The Hub</a> for the latest Johns Hopkins news.</p>'},utility:{getPublishDate:function(e){var n=new Date(e*1e3),r=t.utility.getMonth(n),i=n.getDate(),s=n.getFullYear();return fullDate=r+" "+i+", "+s},getMonth:function(e){var t=["January","February","March","April","May","June","July","August","September","October","November","December"];return t[e.getMonth()]},compileData:function(){var e={};e.per_page=t.utility.isNumeric(t.data.count)?t.data.count:t.defaultCount;t.data.topics&&(e.topics=t.utility.cleanList(t.data.topics));t.data.tags&&(e.tags=t.utility.cleanList(t.data.tags));return e},cleanList:function(e){return e.replace(/\s/g,"")},removeClass:function(e,t){var n=e.className;n=n.trim().split(" ");var r=n.indexOf(t);n.splice(r,1);e.className=n.join(" ")},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)}}}}(hubJS);widgetCreator.create();