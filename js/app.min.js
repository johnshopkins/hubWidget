/**
 * @codekit-append "app/hubJS.js"
 * @codekit-append "app/hubWidget.js"
 *//* **********************************************
     Begin hubJS.js
********************************************** */var hubJS=function(e,t){var n,r={version:0};return{userSettings:{},baseUrl:"http://api.hub.jhu.edu/",init:function(e){n=this;n.userSettings=t.extend({},r,e)},get:function(e,r,i){var r=t.extend({},r);r.v=n.userSettings.version;if(r.id){e=e+"/"+r.id;delete r.id}return t.ajax({url:n.baseUrl+e,dataType:"jsonP",data:r,success:i,fail:n.userSettings.fail})},articles:{find:function(e,r){var e=t.extend({},e);return n.get("articles",e,r)},recent:function(e,r){var e=t.extend({},e);return n.articles.find(e,r)},popular:function(e,r){var e=t.extend({},e,{order_by:"score",score:"trending"});return n.get("articles",e,r)},related:function(e,r,i){var s=r&&r.excluded_ids?e+","+r.excluded_ids:e,r=t.extend({},r,{excluded_ids:s}),o,u=n.articles.find({id:e}),a=u.then(function(e){var i=n.utility.extractEmbeddedItemIds(e,"tags"),s=t.extend({},r,{tags:i.join(",")});return n.articles.find(s)}),f=u.then(function(e){var i=n.utility.extractEmbeddedItemIds(e,"topics"),s=t.extend({},r,{topics:i.join(",")});return f=n.articles.find(s)});a.done(function(e){o=e._embedded.articles?"tags":"topics"});return o=="tags"?a.done(i):f.done(i)}},utility:{extractEmbeddedItemIds:function(e,t){var n=e&&e._embedded&&e._embedded[t]||[];return n.map(function(e){return e.id})}}}}(window,jQuery),hubWidget=function(e,t){var n,r="News from the Hub";return{init:function(){var i='<div class="header">'+r+"</div>";i+='<div class="content loading"></div>';i+='<div class="hubpower"><a href="http://hub.jhu.edu"><span>Powered by the Hub</span></a></div>';e("#hubWidget").html(i);n=this;t.init({v:0});t.baseUrl="http://api.hub.jhu.edu/";return n},getArticles:function(){t.articles.find({per_page:5},function(e){e.error?n.displayError():n.populateWidget(e._embedded.articles)});return n},populateWidget:function(t){e("#hubWidget .content").removeClass("loading");e("#hubWidget .content").html(e("<ul>"));e.each(t,function(t,r){var i='<li><p class="headline"><a href="'+r.url+'">'+r.headline+"</a></p>",i=i+'<p class="pubdate">'+n.utility.getPublishDate(r.publish_date)+"</a></p></li>";e("#hubWidget ul").append(i)})},utility:{getPublishDate:function(e){var t=new Date(e*1e3),r=n.utility.getMonth(t),i=t.getDate(),s=t.getFullYear();return fullDate=r+" "+i+", "+s},getMonth:function(e){var t=["January","February","March","April","May","June","July","August","September","October","November","December"];return t[e.getMonth()]}},displayError:function(){e("#hubWidget .content").html('<p>Sorry, no results were found. Trying checking out <a href="http://hub.jhu.edu">The Hub</a> for the latest Johns Hopkins news.</p>')}}}(jQuery,hubJS);jQuery(document).ready(function(e){hubWidget.init().getArticles()});